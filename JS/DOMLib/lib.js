const DOMLib=function(){const e=e=>new Promise((t,a)=>{const n=new XMLHttpRequest;n.open("GET",e,!0),n.send(null),n.onreadystatechange=(()=>{if(4===n.readyState&&200===n.status){1!==n.getResponseHeader("Content-Type").indexOf("text")&&t(n.responseText)}else 4===n.readyState&&t(n)})});function t(t,a,n,s){this.title=t,this.htmlDirectory=a,this.htmlPartialLoaded=!1,e(this.htmlDirectory).then(e=>{this.htmlPartial=e,this.htmlPartialLoaded=!0,s.$progress()}),this.jsControllerDirectory=n,this.jsControllerLoaded=!1,e(this.jsControllerDirectory).then(e=>{this.jsController=e,this.jsControllerLoaded=!0,s.$progress()})}class a{constructor(e,t,a){this.name=e,this.value=t,this.settings=a}}class n{constructor(e){this.name=e,this.Variables=[]}DOM(e,t,a=null,n=null,s=[]){const i=n?n.childNodes:document.childNodes;for(let n=0;n<i.length;n++)i[n]&&((!a||i[n].tagName===a.toUpperCase())&&"getAttribute"in i[n]&&i[n].getAttribute(e)&&i[n].getAttribute(e)===t&&s.push(i[n]),i[n].childNodes.length>0&&this.DOM(e,t,a,i[n],s));return s.length>1?s:1===s.length?s[0]:null}CreateVariable(e,t,n){for(let a=0;a<this.Variables.length;a++)if(this.Variables[a].name===e)return this.Variables[a].value=t,this.Variables[a].settings=n,console.warn("["+this.name+"] Called "+this.name+".CreateVariable with the same name ("+e+") as another variable, previous variable overwritten (to set a variable use "+this.name+".SetVariable(name, value))."),this.Variables[a];const s=new a(e,t||void 0,n||["out"]);return s.settings.includes("in")&&this.DOM("name",s.name,"variable")&&(s.value=this.DOM("name",s.name,"variable").textContent),s.settings.includes("out")&&this.DOM("name",s.name,"variable")&&(this.DOM("name",s.name,"variable").textContent=s.value),this.Variables.push(s),s.value}GetVariable(e){for(let t=0;t<this.Variables.length;t++)if(this.Variables[t].name===e)return this.Variables[t].settings.includes("in")&&this.DOM("name",this.Variables[t].name,"variable")&&(this.Variables[t].value=this.DOM("name",this.Variables[t].name,"variable").textContent),this.Variables[t];return null}SetVariable(e,t){for(let a=0;a<this.Variables.length;a++)if(this.Variables[a].name===e){this.Variables[a].value=t,this.Variables[a].settings.includes("out")&&this.DOM("name",this.Variables[a].name,"variable")&&(this.DOM("name",this.Variables[a].name,"variable").textContent=this.Variables[a].value);break}return null}}class s{constructor(e){this.$appName=e,this.$pages=[],this.$pageContentLoaded=0,this.Page="",this.onload=function(){},this.Controllers=[];let t=document.getElementsByTagName("title");if(t.length>0)t[0].innerHTML=this.$appName;else{const e=document.createElement("title");e.textContent=this.$appName,document.getElementsByTagName("head")[0].append(e)}}Input(e,t){return new Promise((a,n)=>{const s=document.createElement("div");s.style["background-color"]="#C8C8C8",s.style["border-radius"]="10px",s.style.position="fixed",s.style.left="20px",s.style.top="20px",s.style.width=window.innerWidth-10+"px",s.style.height=window.innerHeight-10+"px",s.style["z-index"]="1000";const i=document.createElement("h2");i.textContent=e,s.appendChild(i);const l=document.createElement("input");s.appendChild(l),s.appendChild(document.createElement("br"));for(let e=0;e<t.length;e++){const i=document.createElement("button");i.style["padding-left"]=i.style["padding-right"]="6px",i.style["padding-top"]=i.style["padding-bottom"]="4px",i.style["border-radius"]="6px",i.style.cursor="pointer","Ok"!==t[e]&&"Submit"!==t[e]||(i.style["background-color"]="#1E90FF",i.style["border-color"]="#4682B4",i.style.color="#FFFFFF"),i.textContent=t[e],i.addEventListener("click",()=>{"Ok"===i.textContent||"Submit"===i.textContent?a(l.value):"Cancel"!==i.textContent&&"Close"!==i.textContent||n("cancelled by user"),document.getElementsByTagName("body")[0].removeChild(s)}),s.appendChild(i)}document.getElementsByTagName("body")[0].appendChild(s)})}$progress(){this.$pageContentLoaded++,this.$pageContentLoaded===2*this.$pages.length&&this.onload()}GetPage(e){for(let t=0;t<this.$pages.length;t++)if(this.$pages[t].title===e)return this.$pages[t];return null}CreatePage(e,a,n){return this.$pages.push(new t(e,a,n,this))}RefreshAllContent(){this.$pageContentLoaded=0,this.$pages.forEach(e=>new t(e.title,e.htmlDirectory,e.jsControllerDirectory,this))}Render(e){if(e||""===this.Page||"string"!=typeof this.Page){if(!(this.$pages.length>0))throw new Error("["+this.$appName+"] No pages created, create at least one page before rendering the page.");this.Page=e?this.GetPage(e).title:this.$pages[0].title}const t=this.GetPage(this.Page);if(!t.htmlPartialLoaded||!t.jsControllerLoaded)throw new Error("["+this.$appName+"] Page cannot be rendered, content not yet loaded. (Use "+this.$appName+".onload to ensure page contents are not used before loaded.)");document.getElementsByTagName("body")[0].innerHTML=t.htmlPartial;const a=document.createElement("script");a.textContent="{\n\t"+t.jsController.split("\n").join("\n\t")+"\n}",document.getElementsByTagName("body")[0].appendChild(a)}Controller(e){const t=new n(e);return this.Controllers.push(t),t}}return{Init:e=>new s(e),GET:e}}();console.log("Loaded DOMLib.js by Matthew James");
